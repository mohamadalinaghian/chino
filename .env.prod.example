# ==============================================================================
# CHINO CAFE - PRODUCTION ENVIRONMENT CONFIGURATION (EXAMPLE)
# ==============================================================================
# This is an EXAMPLE file.
# Copy to .env.prod (or .env) and replace ALL secrets before deployment.
# NEVER commit real production secrets to version control.
# ==============================================================================

# ==============================================================================
# ENVIRONMENT
# ==============================================================================
# Options: development | production | test
ENVIRONMENT=production

# Debug MUST be false in production
DJANGO_DEBUG=false

# ==============================================================================
# DJANGO CORE
# ==============================================================================
DJANGO_SECRET_KEY=CHANGE_ME_WITH_A_LONG_RANDOM_SECRET_KEY
DJANGO_ALLOWED_HOSTS=chinocafe.ir,www.chinocafe.ir

# Force HTTPS
SECURE_SSL_REDIRECT=true
SECURE_HSTS_SECONDS=31536000
DJANGO_CSRF_COOKIE_SECURE=true
DJANGO_SESSION_COOKIE_SECURE=true

# If behind reverse proxy (nginx, traefik, etc.)
DJANGO_SECURE_PROXY_SSL_HEADER=("HTTP_X_FORWARDED_PROTO","https")

# ==============================================================================
# DATABASE (PostgreSQL)
# ==============================================================================
POSTGRES_DB=chino
POSTGRES_USER=chino_user
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD
POSTGRES_HOST=db
POSTGRES_PORT=5432

# Used by Django-environ
DATABASE_URL=postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# Persistent connections (recommended in production)
DB_CONN_MAX_AGE=60

# ==============================================================================
# REDIS / CACHE
# ==============================================================================
REDIS_URL=redis://redis:6379/1

# ==============================================================================
# CORS & CSRF
# ==============================================================================
CORS_ALLOWED_ORIGINS=https://chinocafe.ir
CSRF_TRUSTED_ORIGINS=https://chinocafe.ir,https://www.chinocafe.ir

# ==============================================================================
# AUTHENTICATION - JWT
# ==============================================================================
# STRONGLY RECOMMENDED FOR PRODUCTION
JWT_ALGORITHM=RS256

# RSA keys (multiline, escaped with \n)
JWT_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nCHANGE_ME\n-----END PRIVATE KEY-----
JWT_PUBLIC_KEY=-----BEGIN PUBLIC KEY-----\nCHANGE_ME\n-----END PUBLIC KEY-----

# Token lifetimes (seconds)
ACCESS_TOKEN_LIFETIME_SECONDS=900
REFRESH_TOKEN_LIFETIME_SECONDS=604800

JWT_ISSUER=chino-cafe
JWT_AUDIENCE=chino-api

# ==============================================================================
# AUTH STRATEGY
# ==============================================================================
AUTH_STRATEGY=bearer

ACCESS_TOKEN_COOKIE_NAME=access_token
REFRESH_TOKEN_COOKIE_NAME=refresh_token

COOKIE_DOMAIN=.chinocafe.ir
COOKIE_SECURE=true
COOKIE_SAMESITE=Lax

# ==============================================================================
# ACCOUNT SECURITY
# ==============================================================================
AUTH_MAX_LOGIN_ATTEMPTS=5
AUTH_MIN_PASSWORD_LENGTH=10

# ==============================================================================
# OTP (OPTIONAL)
# ==============================================================================
OTP_ENABLED=false
OTP_LIFETIME_SECONDS=300
OTP_AUTO_CREATE_USER=false

# ==============================================================================
# SMS PROVIDER
# ==============================================================================
# mock | twilio | nexmo
SMS_PROVIDER=mock

TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_FROM_NUMBER=

NEXMO_API_KEY=
NEXMO_API_SECRET=
NEXMO_FROM_NUMBER=

# ==============================================================================
# EMAIL (SMTP - REQUIRED IN PRODUCTION)
# ==============================================================================
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend

DEFAULT_FROM_EMAIL=noreply@chinocafe.ir
ADMIN_EMAIL=admin@chinocafe.ir

EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=true
EMAIL_USE_SSL=false
EMAIL_HOST_USER=CHANGE_ME
EMAIL_HOST_PASSWORD=CHANGE_ME

# Frontend URL (password reset, emails)
FRONTEND_URL=https://chinocafe.ir

# ==============================================================================
# RATE LIMITING
# ==============================================================================
RATE_LIMITING_ENABLED=true
RATE_LIMITER_REDIS_URL=${REDIS_URL}

AUTH_RATE_LIMIT_LOGIN=5/m
AUTH_RATE_LIMIT_REFRESH=10/m
AUTH_RATE_LIMIT_PASSWORD_RESET=3/h
AUTH_RATE_LIMIT_OTP_REQUEST=3/h
AUTH_RATE_LIMIT_OTP_VERIFY=5/m

# ==============================================================================
# LOGGING
# ==============================================================================
LOG_DIR=/app/logs
USE_SYSLOG=false
SYSLOG_ADDRESS=/dev/log

# ==============================================================================
# AUDIT LOGGING
# ==============================================================================
AUTH_AUDIT_LOGGING_ENABLED=true
AUTH_AUDIT_LOG_RETENTION_DAYS=180

# ==============================================================================
# STATIC & MEDIA
# ==============================================================================
DJANGO_MEDIA_URL=/media/

# ==============================================================================
# PERFORMANCE & LIMITS
# ==============================================================================
DATA_UPLOAD_MAX_MEMORY_SIZE=10485760  # 10 MB

# Gunicorn
WEB_CONCURRENCY=2
PYTHON_MAX_THREADS=4

# ==============================================================================
# FRONTEND (NEXT.JS)
# ==============================================================================
NEXT_PUBLIC_CLIENT_SIDE_API_URL=https://chinocafe.ir/api
NEXT_PUBLIC_SERVER_SIDE_API_URL=https://chinocafe.ir/api
NEXT_PUBLIC_MEDIA_DOMAIN=https://chinocafe.ir
NEXT_PUBLIC_SITE_DOMAIN=https://chinocafe.ir

# Cache revalidation (Next.js)
NEXT_FETCH_REVALIDATE=86400

# ==============================================================================
# CELERY (if enabled)
# ==============================================================================
CELERY_LOG_LEVEL=INFO
